<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>5.0</version>
    <date>2021-05-22T16:55:45Z</date>
    <groups>
        <group>
            <name>Templates/Operating systems</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>Template ubuntu-userparams by Zabbix agent active</template>
            <name>Template ubuntu-userparams by Zabbix agent active</name>
            <description>User parameters file at https://github.com/bartmichu/ubuntu-zabbix-userparams</description>
            <groups>
                <group>
                    <name>Templates/Operating systems</name>
                </group>
            </groups>
            <items>
                <item>
                    <name>Needrestart - kernel</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>ubuntu-userparams.needrestart.kernel</key>
                    <delay>10m</delay>
                    <history>30d</history>
                    <trends>60d</trends>
                    <triggers>
                        <trigger>
                            <expression>{last()}=2</expression>
                            <name>Pending kernel upgrade -  ABI compatible upgrade pending</name>
                            <priority>INFO</priority>
                            <description>Obsolete kernel was detected by needrestart.&#13;
ABI compatible upgrade is pending and reboot is required to ensure that your system benefits from these updates. You should consider rebooting.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                        <trigger>
                            <expression>{last()}=0</expression>
                            <name>Pending kernel upgrade - status unknown or failed to detect</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                        <trigger>
                            <expression>{last()}=3</expression>
                            <name>Pending kernel upgrade - version upgrade pending</name>
                            <priority>INFO</priority>
                            <description>Obsolete kernel was detected by needrestart.&#13;
Version upgrade is pending and reboot is required to ensure that your system benefits from these updates. You should consider rebooting.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Needrestart - libraries</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>ubuntu-userparams.needrestart.libs</key>
                    <delay>10m</delay>
                    <history>30d</history>
                    <trends>60d</trends>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;0</expression>
                            <name>Some services need to be restarted</name>
                            <priority>INFO</priority>
                            <description>There are running services which still use files and libraries deleted or updated by recent upgrades. They should be restarted to benefit from the latest updates.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Needrestart - processes</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>ubuntu-userparams.needrestart.pids</key>
                    <delay>10m</delay>
                    <history>30d</history>
                    <trends>60d</trends>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;0</expression>
                            <name>Some processes need to be restarted</name>
                            <priority>INFO</priority>
                            <description>There are running processes which still use files deleted or updated by recent upgrades. They should be restarted to benefit from the latest updates.</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Reboot required</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>ubuntu-userparams.reboot.required</key>
                    <delay>10m</delay>
                    <history>30d</history>
                    <trends>60d</trends>
                    <valuemap>
                        <name>TruthValue</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}=1</expression>
                            <name>System reboot is required</name>
                            <priority>WARNING</priority>
                            <description>System reboot is needed due to previous update or install of a core library or service.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Support - days to EOL</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>ubuntu-userparams.support.eol</key>
                    <delay>1d</delay>
                    <history>30d</history>
                    <trends>60d</trends>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;=30 and {last()}&gt;=0</expression>
                            <name>Ubuntu release nears its End Of Life</name>
                            <priority>AVERAGE</priority>
                            <description>This is a reminder that installed Ubuntu release will reach the End Of Life milestone very soon. After that milestone it will not receive security patches or other software updates and will not be supported by its vendor.&#13;
You should look into upgrade paths immediately if you haven't already.</description>
                        </trigger>
                        <trigger>
                            <expression>{last()}&lt;=90 and {last()}&gt;=31</expression>
                            <name>Ubuntu release nears its End Of Life</name>
                            <priority>WARNING</priority>
                            <description>This is a reminder that installed Ubuntu release will soon reach the End Of Life milestone. After that milestone it will not receive security patches or other software updates and will not be supported by its vendor.&#13;
You should look into upgrade paths.</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Support - status</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>ubuntu-userparams.support.status</key>
                    <delay>1d</delay>
                    <history>30d</history>
                    <trends>60d</trends>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;1</expression>
                            <name>Unsupported Ubuntu release</name>
                            <priority>HIGH</priority>
                            <description>Installed Ubuntu release reached the End Of Life milestone and is not supported by its vendor. It will not receive security patches or other software updates.</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Updates - all</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>ubuntu-userparams.updates.all</key>
                    <delay>10m</delay>
                    <history>30d</history>
                    <trends>60d</trends>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;0</expression>
                            <name>Package updates are available</name>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Unattended upgrades</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>ubuntu-userparams.updates.automatic</key>
                    <delay>1h</delay>
                    <history>30d</history>
                    <trends>60d</trends>
                    <triggers>
                        <trigger>
                            <expression>{last()}=0</expression>
                            <name>Unattended upgrades are not enabled</name>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Updates - security</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>ubuntu-userparams.updates.security</key>
                    <delay>10m</delay>
                    <history>30d</history>
                    <trends>60d</trends>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;0</expression>
                            <name>Security updates are available</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
            </items>
        </template>
    </templates>
    <value_maps>
        <value_map>
            <name>TruthValue</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>true</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>false</newvalue>
                </mapping>
            </mappings>
        </value_map>
    </value_maps>
</zabbix_export>
